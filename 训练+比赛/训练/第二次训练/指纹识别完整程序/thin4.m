function T=thin4(A)
[row,vol]=size(A);
B=zeros(row,vol);
% array=[0,0,1,1,0,0,1,1,1,1,0,1,1,1,0,1,1,1,0,0,1,1,1,1,0,0,0,0,0,0,0,1,0,0,1,1,0,0,1,1,1,1,0,1,1,1,0,1,1,1,0,0,1,1,1,1,0,0,0,0,0,0,0,1,1,1,0,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,1,1,0,0,1,1,0,1,1,1,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,1,1,1,1,0,1,1,1,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,1,1,1,1,0,1,1,1,0,1,1,1,0,0,1,1,1,1,0,0,0,0,0,0,0,1,0,0,1,1,0,0,1,1,1,1,0,1,1,1,0,1,1,1,0,0,1,1,1,1,0,0,0,0,0,0,0,0,1,1,0,0,1,1,0,0,1,1,0,1,1,1,0,0,1,1,0,0,1,1,1,0,1,1,0,0,1,0,0,0];
%建立一张表进行细化
array=[0,0,1,1,0,0,1,1,1,1,0,1,1,1,0,1,1,1,0,0,1,1,1,1,0,0,0,0,0,0,0,1,0,0,1,1,0,0,1,1,1,1,0,1,1,1,0,1,1,1,0,0,1,1,1,1,0,0,0,0,0,0,0,1,1,1,0,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,1,1,0,0,1,1,0,1,1,1,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,1,1,1,1,0,1,1,1,0,1,1,1,0,0,1,1,1,1,0,0,0,0,0,0,0,1,0,0,1,1,0,0,1,1,1,1,0,1,1,1,0,1,1,1,0,0,1,1,1,1,0,0,0,0,0,0,0,0,1,1,0,0,1,1,0,0,0,0,0,0,0,0,0,0,1,1,0,0,1,1,1,1,0,0,0,0,0,0,0,0,1,1,0,0,1,1,0,0,1,1,0,1,1,1,0,0,1,1,0,0,1,1,1,0,1,1,0,0,1,0,0,0];
while ~isequal(B,A)
    B=A;
    for i=2:row-1
        ab=0;
        for j=2:vol-1
            if ab==1%判断邻点是否做了细化
                ab=0;
                continue;
            end
            if A(i,j)==0 && (A(i,j-1)==1 | A(i,j+1)==1)%判断邻点是否有白点
                sum=A(i-1,j-1)*1+A(i-1,j)*2+A(i-1,j+1)*4+A(i,j-1)*8+A(i,j+1)*16+A(i+1,j-1)*32+A(i+1,j)*64+A(i+1,j+1)*128;%计算表的索引值
                if array(1,sum+1)==1
                    A(i,j)=1;
                    ab=1;
                end
            end
        end
    end
    for j=2:vol-1
        ab=0;
        for i=2:row-1
            if ab==1%判断邻点是否做了细化
                ab=0;
                continue;
            end
            if A(i,j)==0 && (A(i-1,j)==1 | A(i+1,j)==1)%判断邻点是否有白点
                sum=A(i-1,j-1)*1+A(i-1,j)*2+A(i-1,j+1)*4+A(i,j-1)*8+A(i,j+1)*16+A(i+1,j-1)*32+A(i+1,j)*64+A(i+1,j+1)*128;%计算表的索引值
                if array(1,sum+1)==1
                    A(i,j)=1;
                    ab=1;
                end
            end
        end
    end
end

T=A;
end